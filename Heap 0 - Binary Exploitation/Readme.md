# Heap 0 picoCTF Write-Up

## Challenge Description
You are given a heap exploitation challenge where you can write arbitrary data to a heap buffer and attempt to print the flag.

## Solution Steps

- Connect to the challenge server:
  ```
  nc tethys.picoctf.net 57706
  ```
- The program allocates two adjacent heap blocks:
  - First block (your buffer): e.g., `0x5c7cae9f32b0 -> pico`
  - Second block (safe_var): e.g., `0x5c7cae9f32d0 -> bico`
- The difference between the addresses is 0x20 (32 bytes). Writing more than 32 bytes to your buffer will overflow into `safe_var`.
- Choose option 2 (Write to buffer) and input a long string (e.g., 64+ "A"s) to overflow into `safe_var`.
- Optionally, use option 3 (Print safe_var) to confirm the overflow.
- Choose option 4 (Print Flag) to trigger the win condition and reveal the flag.

## Vulnerability & Why the Exploit Works

The program allocates two consecutive heap blocks. There is no proper bounds checking when writing to your buffer, so overflowing your buffer overwrites `safe_var`. The program's logic for printing the flag depends on the value of `safe_var`, so corrupting it allows you to bypass the check and print the flag.

## Flag
```
picoCTF{my_first_heap_overflow_1ad0e1a6}
```